# Cap√≠tulo 10: Flujos de Trabajo Avanzados

**Duraci√≥n**: 75 minutos
**Dificultad**: Avanzado

---

## üéØ Objetivos de Aprendizaje

Al final de este cap√≠tulo, podr√°s:
- Gestionar proyectos complejos de m√∫ltiples pasos
- Aplicar estrategias efectivas de depuraci√≥n
- Usar Plan Mode vs Normal Mode apropiadamente
- Integrar todas las caracter√≠sticas de Claude Code
- Optimizar tu flujo de trabajo para m√°xima productividad
- Aplicar mejores pr√°cticas a nivel profesional
- Completar proyectos end-to-end con Claude Code

---

## üìñ Lecci√≥n 10.1: Proyectos de M√∫ltiples Pasos

### Anatom√≠a de un Proyecto Complejo

Un proyecto t√≠pico involucra:

```
1. Planificaci√≥n  ‚Üí Qu√© hacer
2. Investigaci√≥n  ‚Üí C√≥mo hacerlo
3. Implementaci√≥n ‚Üí Escribir c√≥digo
4. Testing        ‚Üí Verificar que funcione
5. Revisi√≥n       ‚Üí Asegurar calidad
6. Documentaci√≥n  ‚Üí Explicar el c√≥digo
7. Deployment     ‚Üí Publicar cambios
```

### Estrategia: Divide y Conquistar√°s

**‚ùå Approach Malo:**
```
T√∫: Implementa un sistema completo de autenticaci√≥n con JWT, refresh tokens, OAuth social, rate limiting, y email verification
```

**‚úÖ Approach Bueno:**
```
1. T√∫: Planifiquemos un sistema de autenticaci√≥n
   Claude: [crea plan detallado con TodoWrite]

2. T√∫: Empecemos con la autenticaci√≥n b√°sica JWT
   Claude: [implementa JWT base]

3. T√∫: Ahora agrega refresh tokens
   Claude: [extiende con refresh tokens]

4. T√∫: Agrega OAuth para Google
   Claude: [integra OAuth]

5. T√∫: Implementa rate limiting
   Claude: [agrega rate limiting]

6. T√∫: Finalmente, email verification
   Claude: [completa con email verification]
```

### Usar TodoWrite para Tracking

**Proyecto: Implementar Dashboard de Analytics**

```
TodoWrite:
1. [in_progress] Dise√±ar esquema de base de datos
2. [pending] Crear API endpoints
3. [pending] Implementar queries de analytics
4. [pending] Crear componentes de UI
5. [pending] Integrar gr√°ficas (Chart.js)
6. [pending] Agregar tests
7. [pending] Escribir documentaci√≥n
8. [pending] Optimizar rendimiento
```

Claude marca cada tarea como completada antes de pasar a la siguiente.

### Ejemplo Completo

**T√∫: Quiero implementar un sistema de notificaciones en tiempo real**

**Claude:**
```
Excelente proyecto. Usar√© TodoWrite para organizarlo:

Tareas:
1. [in_progress] Investigar opciones (WebSockets vs SSE vs Polling)
2. [pending] Dise√±ar arquitectura
3. [pending] Implementar servidor WebSocket
4. [pending] Crear cliente de conexi√≥n
5. [pending] Implementar sistema de suscripciones
6. [pending] Agregar persistencia de notificaciones
7. [pending] Crear UI de notificaciones
8. [pending] Agregar tests
9. [pending] Documentar API

Empecemos investigando las opciones...
[usa general-purpose agent para investigar]
[completa tarea 1]
[marca tarea 2 como in_progress]
...
```

---

## üìñ Lecci√≥n 10.2: Estrategias de Depuraci√≥n

### Enfoque Sistem√°tico de Debugging

**1. Reproducir el Bug**
```
T√∫: Tengo un bug en el login

Claude:
- ¬øQu√© error ves exactamente?
- ¬øCu√°les son los pasos para reproducirlo?
- ¬øQu√© comportamiento esperabas?
- ¬øTienes logs o mensajes de error?
```

**2. Aislar el Problema**
```
Claude:
1. [lee el archivo relevante]
2. [busca funciones relacionadas]
3. [revisa imports y dependencias]
4. [identifica punto de falla probable]
```

**3. Analizar el C√≥digo**
```
Claude:
[analiza la l√≥gica]
[identifica posibles causas]
[propone hip√≥tesis]
```

**4. Proponer Soluci√≥n**
```
Claude:
Encontr√© el problema en l√≠nea 45:
- El token no se est√° validando correctamente
- Falta manejo de caso null

Soluciones:
1. Agregar null check
2. Mejorar validaci√≥n de token
3. Agregar logging para debugging futuro
```

**5. Implementar Fix**
```
Claude:
[edita el archivo]
[agrega tests para el bug]
[verifica que el fix funciona]
```

### T√©cnicas de Debugging

**A. An√°lisis de Stack Traces**
```
T√∫: [pega stack trace]

Claude:
1. [identifica l√≠nea exacta del error]
2. [lee contexto alrededor de esa l√≠nea]
3. [analiza qu√© caus√≥ el error]
4. [propone fix]
```

**B. Debugging por Binary Search**
```
Claude:
El bug est√° en esta funci√≥n de 200 l√≠neas.
1. [comenta mitad del c√≥digo]
2. ¬øSigue fallando?
3. Si s√≠ ‚Üí bug en primera mitad
4. Si no ‚Üí bug en segunda mitad
5. [repite hasta encontrar l√≠nea exacta]
```

**C. Agregar Logging Estrat√©gico**
```
Claude:
[agrega console.log en puntos clave]
[ejecuta c√≥digo]
[analiza output]
[identifica d√≥nde falla]
[remueve logs temporales]
```

**D. Usar Debugging Tools**
```
Claude:
[configura debugger]
[agrega breakpoints]
[ejecuta paso a paso]
[inspecciona variables]
```

### Debugging con MCP

**Integraci√≥n con Sentry:**
```
T√∫: Debuggea el error #ERR-456 de Sentry

Claude:
1. [sentry__get_error id="ERR-456"]
2. [analiza stack trace y contexto]
3. [lee archivos relevantes]
4. [identifica causa root]
5. [implementa fix]
6. [actualiza issue en Sentry]
```

---

## üìñ Lecci√≥n 10.3: Plan Mode vs Normal Mode

### ¬øQu√© es Plan Mode?

**Plan Mode** es cuando Claude planifica antes de ejecutar.

```
Plan Mode: Planifica ‚Üí Usuario aprueba ‚Üí Ejecuta
Normal Mode: Ejecuta directamente
```

### Cu√°ndo Usar Plan Mode

**‚úÖ Usar Plan Mode cuando:**
- Tarea compleja con m√∫ltiples pasos
- Cambios significativos al c√≥digo
- No est√°s 100% seguro del approach
- Quieres revisar antes de ejecutar
- Proyecto con muchos archivos afectados

**‚ùå NO usar Plan Mode cuando:**
- Tarea simple de 1-2 pasos
- Solo lectura/investigaci√≥n
- Cambios peque√±os conocidos
- Iteraci√≥n r√°pida

### Activar Plan Mode

```bash
# Iniciar en plan mode
claude --permission-mode plan

# Dentro de sesi√≥n
T√∫: Entra en plan mode para esta tarea
```

### Ejemplo: Refactorizaci√≥n Grande

**Plan Mode:**
```
T√∫: Refactoriza el sistema de auth para usar TypeScript

Claude: [PLAN MODE]

Plan de Refactorizaci√≥n:

1. Investigaci√≥n (5 min)
   - Analizar c√≥digo JavaScript actual
   - Identificar tipos necesarios

2. Configuraci√≥n (10 min)
   - Agregar tsconfig.json
   - Instalar @types/node, @types/express
   - Configurar build pipeline

3. Conversi√≥n (30 min)
   - Convertir auth.js ‚Üí auth.ts
   - Agregar interfaces para User, Token
   - Convertir middleware.js ‚Üí middleware.ts
   - Agregar tipos para request/response

4. Testing (15 min)
   - Ejecutar tests existentes
   - Verificar tipos con tsc
   - Fix type errors

5. Documentation (10 min)
   - Actualizar README
   - Agregar comentarios de tipos

¬øAprobar este plan?

T√∫: Aprobado, procede

Claude: [NORMAL MODE]
[ejecuta el plan paso a paso]
```

### Ventajas de Plan Mode

- üëÅÔ∏è **Visibilidad**: Ves qu√© har√° Claude antes de hacerlo
- üõ°Ô∏è **Seguridad**: Puedes cancelar si algo se ve mal
- üéØ **Claridad**: Entiendes el approach completo
- üìã **Tracking**: Plan sirve como checklist

---

## üìñ Lecci√≥n 10.4: Integraci√≥n de Todas las Caracter√≠sticas

### El Stack Completo de Claude Code

Combina todas las herramientas aprendidas:

```
Herramientas Base ‚Üí Slash Commands ‚Üí Agentes ‚Üí Hooks ‚Üí MCP
        ‚Üì                ‚Üì              ‚Üì         ‚Üì      ‚Üì
    Todo List      Workflows     Specialist  Automation  External Data
```

### Proyecto Integrado: Sistema de Blog

**Setup Inicial:**

**1. Comandos Slash** (`.claude/commands/`)
```markdown
# blog-post.md
Create a new blog post:
1. Create markdown file
2. Add frontmatter (title, date, author)
3. Generate post template
4. Open in editor
```

**2. Agentes** (`.claude/agents/`)
```json
{
  "name": "seo-optimizer",
  "description": "Optimizes blog posts for SEO",
  "systemPrompt": "Analyze blog posts for SEO..."
}
```

**3. Hooks** (`.claude/settings.local.json`)
```json
{
  "hooks": {
    "PostToolUse": [
      {
        "matcher": "Write:blog/*.md",
        "hooks": [
          {
            "command": "prettier --write \"$TOOL_INPUT_file_path\""
          }
        ]
      }
    ]
  }
}
```

**4. MCP** (`.mcp.json`)
```json
{
  "servers": {
    "analytics": {
      "transport": "http",
      "url": "https://analytics.example.com"
    }
  }
}
```

**Workflow Completo:**

```
T√∫: /blog-post

Claude:
1. [ejecuta comando slash blog-post]
2. [crea archivo con Write]
3. [Hook formatea autom√°ticamente]
4. [lanza seo-optimizer agent]

SEO Optimizer Agent:
- Sugiere keywords
- Optimiza meta description
- Verifica heading structure
- [devuelve recomendaciones]

Claude:
5. [aplica optimizaciones SEO]
6. [consulta analytics via MCP]
7. [sugiere topics relacionados populares]

‚úÖ Post creado y optimizado: blog/new-post.md
```

---

## üìñ Lecci√≥n 10.5: Optimizaci√≥n de Rendimiento

### Uso Eficiente de Herramientas

**A. Ejecuci√≥n Paralela**
```
‚úÖ R√°pido:
Claude: [ejecuta en paralelo]
- Read: file1.js
- Read: file2.js
- Read: file3.js
- Grep: "TODO"
- Bash: git status

‚ùå Lento:
Claude: [ejecuta secuencialmente]
- Read file1.js ‚Üí espera
- Read file2.js ‚Üí espera
- Read file3.js ‚Üí espera
- Grep "TODO" ‚Üí espera
- Bash git status ‚Üí espera
```

**B. Usar Agentes Apropiadamente**
```
‚úÖ Usar Agent:
- B√∫squeda compleja multi-archivo
- Investigaci√≥n que requiere m√∫ltiples intentos

‚ùå NO usar Agent:
- Conoces el archivo exacto ‚Üí usa Read
- B√∫squeda simple ‚Üí usa Grep directamente
```

**C. Herramientas Especializadas**
```
‚úÖ Usar herramientas especializadas:
- Read para leer archivos
- Edit para modificar
- Grep para buscar contenido

‚ùå NO usar bash:
- cat para leer ‚Üí usa Read
- sed para editar ‚Üí usa Edit
- grep para buscar ‚Üí usa Grep
```

### Gesti√≥n de Contexto

**A. Compactar Regularmente**
```
/compact

Libera espacio en contexto manteniendo informaci√≥n importante.
```

**B. Clear Cuando Sea Apropiado**
```
/clear

Usa entre tareas completamente diferentes para empezar fresco.
```

**C. Verificar Uso de Contexto**
```
/context

Ve cu√°nto contexto est√°s usando y cu√°nto queda libre.
```

### Performance Tips

**1. Batch Operations**
```
‚úÖ Bueno: "Edita estos 3 archivos [lista]"
‚ùå Malo: 3 prompts separados para cada archivo
```

**2. Espec√≠fico > Vago**
```
‚úÖ "Lee src/auth/login.js l√≠neas 40-60"
‚ùå "Lee el archivo de login y busca la funci√≥n"
```

**3. Usar Search Filters**
```
‚úÖ Grep con type="js" glob="src/**"
‚ùå Grep sin filtros en todo el proyecto
```

---

## üìñ Lecci√≥n 10.6: Mejores Pr√°cticas Profesionales

### 1. Documentaci√≥n Mientras Desarrollas

```
Claude approach:
- Escribe c√≥digo
- Agrega comentarios inline
- Actualiza README si aplica
- Genera documentaci√≥n de API
- Todo en una sesi√≥n
```

### 2. Testing Desde el Inicio

```
TDD con Claude:
1. Escribe test primero
2. Implementa feature
3. Verifica que test pasa
4. Refactoriza
5. Repite
```

### 3. Code Review Continuo

```
Durante desarrollo:
1. Implementa feature
2. /review-code (comando slash)
3. Claude revisa autom√°ticamente
4. Aplica sugerencias
5. Contin√∫a
```

### 4. Commits At√≥micos

```
‚úÖ Buenos commits:
- Un feature ‚Üí un commit
- Mensaje descriptivo
- Tests incluidos

‚ùå Malos commits:
- "Update files"
- 10 features mezclados
- Sin tests
```

### 5. Iteraci√≥n R√°pida

```
Ciclo:
1. Intenta ‚Üí 2. Prueba ‚Üí 3. Ajusta ‚Üí Repite

No busques perfecci√≥n en primer intento.
```

### 6. Aprende de los Errores

```
Cuando algo falla:
1. Lee el error completamente
2. Entiende qu√© caus√≥ el problema
3. Aprende c√≥mo evitarlo
4. Documenta la soluci√≥n
```

### 7. Automatiza lo Repetitivo

```
Si haces algo 3+ veces:
‚Üí Cr√©alo como comando slash
‚Üí O configura un hook
‚Üí O crea un agente
```

---

## üìñ Lecci√≥n 10.7: Proyecto End-to-End

### Ejemplo: API REST Completa

**Especificaci√≥n:**
Sistema de gesti√≥n de tareas (TODO app) con API REST.

**Paso 1: Planificaci√≥n**
```
T√∫: Necesito crear una API REST para gesti√≥n de tareas

Claude: [usa TodoWrite]
Plan del Proyecto:
1. [in_progress] Dise√±ar schema de base de datos
2. [pending] Configurar proyecto (Express + TypeScript)
3. [pending] Implementar modelos de datos
4. [pending] Crear endpoints CRUD
5. [pending] Agregar autenticaci√≥n
6. [pending] Implementar validaci√≥n
7. [pending] Escribir tests
8. [pending] Agregar documentaci√≥n
9. [pending] Setup CI/CD
```

**Paso 2: Database Design**
```
Claude:
[crea schema.sql]
- Users table
- Tasks table
- Categories table
- Tags table

[marca tarea 1 completada]
[tarea 2 in_progress]
```

**Paso 3: Project Setup**
```
Claude:
[ejecuta en paralelo]
- npm init
- npm install dependencies
- crea tsconfig.json
- estructura de carpetas
- configuraci√≥n de linting

[Hook auto-formatea archivos]
[marca tarea 2 completada]
```

**Paso 4-6: Implementaci√≥n**
```
Claude:
[para cada feature]
1. Implementa c√≥digo
2. [lanza test-writer agent]
3. Agent escribe tests
4. Claude ejecuta tests
5. Fix si fallan
6. Marca tarea completada
```

**Paso 7: Code Review**
```
Claude:
[lanza code-reviewer agent]
- Revisa toda la implementaci√≥n
- Sugiere mejoras
- Verifica best practices
```

**Paso 8: Documentation**
```
Claude:
[lanza documentation agent]
- README completo
- API documentation
- Setup instructions
- Deployment guide
```

**Paso 9: Deployment**
```
Claude:
1. [crea Dockerfile]
2. [configura CI/CD]
3. [crea scripts de deployment]
4. [documenta proceso]
```

**Resultado Final:**
- ‚úÖ API REST funcional
- ‚úÖ Tests completos (90%+ coverage)
- ‚úÖ Documentaci√≥n detallada
- ‚úÖ Lista para deployment
- ‚è±Ô∏è Completado en 2-3 horas vs d√≠as manualmente

---

## üõ†Ô∏è Ejercicios de Pr√°ctica

### Ejercicio 10.1: Proyecto Multi-Paso
Crea un peque√±o proyecto con Claude usando TodoWrite:
1. CLI tool que lee un archivo CSV
2. Procesa los datos
3. Genera un reporte en HTML
4. Incluye tests
5. Documenta el uso

### Ejercicio 10.2: Debugging Challenge
1. Introduce un bug intencional en c√≥digo existente
2. Pide a Claude que lo encuentre y arregle
3. Observa su metodolog√≠a de debugging

### Ejercicio 10.3: Integraci√≥n Completa
Crea un workflow que use:
- Comando slash personalizado
- Agente especializado
- Hook para formateo
- TodoWrite para tracking

### Ejercicio 10.4: Optimizaci√≥n
Toma una tarea que hiciste antes y:
1. Identifica pasos ineficientes
2. Optim√≠zala con ejecuci√≥n paralela
3. Mide la mejora en tiempo

---

## üìù Examen Final: Proyecto Completo

### Especificaciones del Proyecto

Crea un **sistema completo de blog** con las siguientes caracter√≠sticas:

**Requerimientos Funcionales:**
1. CRUD de posts (Create, Read, Update, Delete)
2. Sistema de categor√≠as
3. B√∫squeda de posts
4. Sistema de tags
5. Autenticaci√≥n b√°sica
6. API REST

**Requerimientos T√©cnicos:**
1. TypeScript + Node.js + Express
2. Tests (Jest)
3. Documentaci√≥n completa
4. Git con commits descriptivos
5. README con setup instructions

**Requerimientos de Claude Code:**
1. Usa TodoWrite para tracking de progreso
2. Crea al menos 2 comandos slash √∫tiles
3. Crea al menos 1 agente especializado
4. Configura hooks para auto-formateo
5. Demuestra debugging de al menos 1 bug

### Criterios de Evaluaci√≥n

**Funcionalidad (30 puntos)**
- Todas las features funcionan correctamente
- C√≥digo limpio y bien organizado
- Manejo de errores apropiado

**Testing (20 puntos)**
- Tests comprehensivos
- Coverage >70%
- Tests pasan

**Documentaci√≥n (15 puntos)**
- README claro
- C√≥digo comentado
- API documentada

**Uso de Claude Code (25 puntos)**
- TodoWrite usado efectivamente
- Comandos slash √∫tiles
- Agente bien dise√±ado
- Hooks configurados correctamente

**Best Practices (10 puntos)**
- Commits at√≥micos y descriptivos
- Estructura de proyecto clara
- C√≥digo siguiendo est√°ndares

**Total: 100 puntos**

### Entrega

1. Repositorio Git completo
2. Demostraci√≥n del proyecto funcionando
3. Explicaci√≥n de c√≥mo usaste cada feature de Claude Code
4. Reflexi√≥n: ¬øQu√© aprendiste? ¬øQu√© har√≠as diferente?

---

## ‚úÖ C√≥mo Enviar Tu Examen Final

1. Completa el proyecto
2. Haz push al repositorio
3. Proporciona link al repo
4. Demuestra funcionalidad key
5. Explica tu proceso de desarrollo

---

## üéØ ¬°Cap√≠tulo 10 Completo!

Has dominado los flujos de trabajo avanzados. Ahora est√°s listo para el Cap√≠tulo 11: Optimizaci√≥n y Uso Eficiente, donde aprender√°s a maximizar tu productividad y minimizar costos.

**Anterior**: `capitulo_09.md`
**Siguiente**: `capitulo_11.md`
